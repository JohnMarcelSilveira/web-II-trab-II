<%- include('partials/header', { titulo: 'Lista de Usuários' }) %>

  <div class="container">
    <h1>Usuários</h1>

    <form method="GET" action="/users" class="filter-form">
      <input type="text" name="nome" placeholder="Filtrar por nome" value="<%= filtro || '' %>">
      <button type="submit" class="btn btn-primary">Filtrar</button>
    </form>

    <div class="table-container">
      <table class="users-table">
        <thead>
          <tr>
            <th>Nome</th>
            <th>CPF</th>
            <th>Perfil</th>
            <th>Ações</th>
          </tr>
        </thead>
        <tbody>
          <% users.forEach(user=> { %>
            <tr>
              <td>
                <%= user.nome %>
              </td>
              <td>
                <%= user.cpf %>
              </td>
              <td>
                <%= user.perfil %>
              </td>
              <td class="actions">
                <a href="/updateUser/<%= user.id %>" class="btn btn-edit">Editar</a>
                <% if (session && session.user && session.user.perfil==='ADMIN' && user.perfil !=='ADMIN' ) { %>
                  <a href="/deleteUser/<%= user.id %>" class="btn btn-delete">Excluir</a>
                  <% } %>
              </td>
            </tr>
            <% }) %>
        </tbody>
      </table>
    </div>

    <div class="pagination">
      <span class="page-info">Página <%= pagina %></span>
      <div class="pagination-buttons">
        <% if (pagina> 1) { %>
          <a href="/users?pagina=<%= pagina - 1 %>&nome=<%= filtro || '' %>" class="btn btn-pagination">Anterior</a>
          <% } %>
            <% if (temMais) { %>
              <a href="/users?pagina=<%= pagina + 1 %>&nome=<%= filtro || '' %>" class="btn btn-pagination">Próxima</a>
              <% } %>
      </div>
    </div>

    <div class="footer-actions">
      <a href="/home" class="btn btn-back">Voltar para Home</a>
    </div>
  </div>

  <%- include('partials/footer') %>